<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
		<title>tagging tool</title>
		<style type="text/css" media="screen">
			h1 {
				font-family: "helvetica";
				font-size: 72px;
				letter-spacing: -5px;
				text-transform: lowercase;
				color: #656696;
			}
			.clearfix {
				_height:1%;
				zoom:1;
			}
			.clearfix:after {
				content:".";
				visibility:hidden;
				display:block;
				clear:both;
				height:0;
			}
			
			.tag_box * {
				margin: 0;
				padding: 0;
				outline: none;
			}
			
			.tag_box {
				border: 1px solid #000;
				margin: 10px;
				min-height: 60px;
				cursor: text;

			}
			
			.tag_box span.tag {
				float: left;
				font-family: "Lucida Grande","Verdana";
			}
			.tag_box span.tag label {
				background: #656696;
				border: 1px solid transparent;
				-webkit-border-radius: 5px;
				-moz-border-radius: 5px;
				margin: 3px 0 3px 5px;
				padding-right: 20px;
				position: relative;
				display: inline-block;
				min-width: 20px;
				height: 20px;
			}
			.tag_box span.tag label abbr:hover {
				cursor: pointer;
			}
			.tag_box span.tag label abbr {
				color: #FFF;
				border: none;
				font-size: 8px;
				font-weight: bold;
				line-height: 12px;
				position: absolute;
				right: 3px;
				z-index: 9999;
				height: 100%;
				line-height: 22px;
			}
			.tag_box span.tag input {
				border: none;
				background: transparent;
				color: #fff;
				position: absolute;
				left:0;
				width: 100%;
				height: 15px;
				z-index: 0;
/*				line-height: 20px;*/
				text-align: center;
				padding: 0;
				top: 3px;
			}
			span.tag input, span.tag label span {
				font-family: "Lucida Grande","Verdana";
				font-size: 11px;
			}
			.tag_box span.tag label span {
				display: inline-block;
				visibility: hidden;
				margin-left: 5px;

			}
			.example {
				display: none !important;
			}
			
		</style>
		<link rel="stylesheet" href="colours.css" type="text/css" media="screen" title="no title" charset="utf-8">
		
		<script src="http://www.google.com/jsapi"></script>
		
		<script type="text/javascript" charset="utf-8">
			
		</script>
		<script>
		  // Load 
		  google.load("jquery", "1");
		  google.setOnLoadCallback(function() {
				jQuery.fn.tag_box = function(setup) {
					
					var setup = setup || {}
					var content = this;
					$(this).append('<span class="tag example"><label><span></span><input type="text" name="tag" value=" " /><abbr title="Fechar">X</abbr></label></span>');

					$(this).find('.tag.example').click(function(e) {
							e.stopPropagation();

							var target = $(e.target);
							if(target.is('abbr')){

								$(this).animate({width:'hide'},'fast',function() {
									$(this).remove();
								})
								return false;
							}
							if (target.is('span.tag')) {
								target.before(new_tag());
								target.prev('.tag').find(':input').focus();
							};

					})
					$(this).click(function(e) {
							$(this).append(new_tag()).find('.tag:last input').focus();
					})

					var blur_tag = function(e) {
						if (!$.trim($(this).val())) {
							setTimeout(function() {
								$(e.target).closest('.tag').remove();
							}, 100);
						};
					}

					var	new_tag = function(text) {
						var text = text || ""
						
						return $('.tag.example')
								.clone(true).removeClass('example')
									.find('input')
									.val(text)
									.blur(setup.blur)
									.blur(blur_tag)
									.keydown(setup.keydown)
									.keydown(function(e) {
										if(e.keyCode == 188 || e.keyCode == 13){
											e.preventDefault();
										}
										if(e.keyCode==9 || e.keyCode == 188 || e.keyCode == 13){ // if TAB, ENTER or ,
											if (!e.shiftKey && $.trim($(this).val()) && !$(this).closest('.tag').next('.tag').length) {
														var tag = $(this).closest('.tag').after(new_tag());
														setTimeout(function() {
															tag.next('.tag').find('input').focus();
														}, 50);
														return false;
												}
											}	
									})
									.keyup(setup.keyup)
									.keyup(function() {
										var target = $(this);
										target.siblings('span').html(this.value.replace(/ /gim, '&nbsp;')+"M");
										if(this.value.indexOf(",") !== -1){
											var tags = this.value.split(','),
											tag = target.closest('.tag');
											target.val(tags[0]).siblings('span').html(this.value.replace(/ /gim, '&nbsp;')+"M");
											for (var i = tags.length - 1; i > 0; i--){
												$(tag).after( new_tag(tags[i]) );
											};
											
										}
									})
									.keyup()
									.end();
					}

					$(this).click();
				}
			$('.tag_box').tag_box({
				keyup: function(e){
					clearTimeout(this.colorTimeout);
					this.colorTimeout = setTimeout(function() {
						e.target.parentNode.className = e.target.value.replace(/[-]/gim," ").toLowerCase();
					}, 300);
					
				}
			});
			})
		</script>
	</head>
	<body>
		<h1>Tagbox</h1>
		
		<div class="tag_box clearfix">		
			
		</div>
	</body>
</html>